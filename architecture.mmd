%%{init: {'theme': 'default'}}%%
graph TD
    subgraph "Pipeline de Varredura"
        A[Scan Worker Pool] -->|Usa| B[Protocol Dispatcher]
    end

    subgraph "Protocolos (Pluggable)"
        B -->|Dispatch| C[Probe Registry]
        B -->|Dispatch| D[Client Registry]

        C --> E[(HTTP Probe)]
        C --> F[(Redis Probe)]
        C --> G[(TLS Fingerprinter)]
        C --> H[(Custom Probe)]

        D --> I[(FTP Client)]
        D --> J[(SMTP Client)]
        D --> K[(SSH Client)]
        D --> L[(MySQL Client)]
        D --> M[(Custom Client)]
    end

    subgraph "I/O & SaÃ­da"
        A -->|Envia| N[Output Channel]
        N --> O[Output Sink]
        O --> P[(JSONL)]
        O --> Q[(Pretty)]
        O --> R[(Remote Queue / API)]
    end

    classDef core fill:#e6f3ff,stroke:#333;
    classDef proto fill:#f0f9eb,stroke:#333;
    classDef io fill:#fdeff2,stroke:#333;

    class A,B,N,O core
    class C,D,E,F,G,H,I,J,K,L,M proto
    class P,Q,R io
